{"ast":null,"code":"import _slicedToArray from \"/home/cyan/Desktop/projects/go-react-chat/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport { useEffect, useState, useRef } from \"react\";\nimport socketIOClient from \"socket.io-client\";\nconst backend = \"ws://localhost:5300\";\n\nfunction useChat() {\n  let socketRef = useRef();\n\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        messages = _useState2[0],\n        setMessages = _useState2[1];\n\n  useEffect(() => {\n    socketRef.current = socketIOClient(backend, {\n      transports: ['websocket']\n    });\n    setMessages(messages);\n    socketRef.current.on(\"newChatMessage\", function (msg) {\n      console.log(msg);\n      setMessages(messages => [...messages, msg.message]);\n    });\n    return () => {\n      socketRef.current.disconnect();\n    };\n  }, []);\n\n  const sendMessage = message => {\n    socketRef.current.emit(\"newChatMessage\", {\n      message\n    });\n  };\n\n  return {\n    messages,\n    sendMessage\n  };\n}\n\nexport default useChat;","map":{"version":3,"sources":["/home/cyan/Desktop/projects/go-react-chat/frontend/src/hooks/useChat/useChat.jsx"],"names":["useEffect","useState","useRef","socketIOClient","backend","useChat","socketRef","messages","setMessages","current","transports","on","msg","console","log","message","disconnect","sendMessage","emit"],"mappings":";AAAA,SAASA,SAAT,EAAoBC,QAApB,EAA8BC,MAA9B,QAA4C,OAA5C;AACA,OAAOC,cAAP,MAA2B,kBAA3B;AAEA,MAAMC,OAAO,GAAG,qBAAhB;;AAEA,SAASC,OAAT,GAAmB;AACf,MAAIC,SAAS,GAAGJ,MAAM,EAAtB;;AADe,oBAEiBD,QAAQ,CAAC,EAAD,CAFzB;AAAA;AAAA,QAERM,QAFQ;AAAA,QAEEC,WAFF;;AAIfR,EAAAA,SAAS,CAAC,MAAM;AACZM,IAAAA,SAAS,CAACG,OAAV,GAAoBN,cAAc,CAACC,OAAD,EAAU;AAACM,MAAAA,UAAU,EAAE,CAAC,WAAD;AAAb,KAAV,CAAlC;AACAF,IAAAA,WAAW,CAACD,QAAD,CAAX;AAEAD,IAAAA,SAAS,CAACG,OAAV,CAAkBE,EAAlB,CAAqB,gBAArB,EAAuC,UAAUC,GAAV,EAAe;AAClDC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACAJ,MAAAA,WAAW,CAACD,QAAQ,IAAI,CAAC,GAAGA,QAAJ,EAAcK,GAAG,CAACG,OAAlB,CAAb,CAAX;AACH,KAHD;AAKA,WAAO,MAAM;AACTT,MAAAA,SAAS,CAACG,OAAV,CAAkBO,UAAlB;AACH,KAFD;AAGH,GAZQ,EAYN,EAZM,CAAT;;AAcA,QAAMC,WAAW,GAAIF,OAAD,IAAa;AAC7BT,IAAAA,SAAS,CAACG,OAAV,CAAkBS,IAAlB,CAAuB,gBAAvB,EAAyC;AAACH,MAAAA;AAAD,KAAzC;AACH,GAFD;;AAIA,SAAO;AAAER,IAAAA,QAAF;AAAYU,IAAAA;AAAZ,GAAP;AACH;;AAED,eAAeZ,OAAf","sourcesContent":["import { useEffect, useState, useRef } from \"react\"\nimport socketIOClient from \"socket.io-client\"\n\nconst backend = \"ws://localhost:5300\"\n\nfunction useChat() {\n    let socketRef = useRef();\n    const [messages, setMessages] = useState([]);\n\n    useEffect(() => {\n        socketRef.current = socketIOClient(backend, {transports: ['websocket']});\n        setMessages(messages);\n\n        socketRef.current.on(\"newChatMessage\", function (msg) {\n            console.log(msg);\n            setMessages(messages => [...messages, msg.message])\n        });\n\n        return () => {\n            socketRef.current.disconnect();\n        }\n    }, []);\n\n    const sendMessage = (message) => {\n        socketRef.current.emit(\"newChatMessage\", {message})\n    };\n\n    return { messages, sendMessage }\n}\n\nexport default useChat"]},"metadata":{},"sourceType":"module"}